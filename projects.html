<!DOCTYPE HTML>
<html>
<head>
    <title>Analog Integrated Systems</title>
    <link href="https://fonts.googleapis.com/css?family=Voces" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="css/common.css"/>
    <link rel="stylesheet" href="css/style.css"/>
    <script src="js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <SCRIPT SRC='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></SCRIPT>
    <SCRIPT>MathJax.Hub.Config({ tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}})</SCRIPT>
    <style>
        .marked{
                background-color: yellow;
                font-weight: bold;
        }
        .marked2{
                background-color: aqua;
                font-weight: bold;
        }
        p{
            font-size: large;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        li{
            font-size: large;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-weight: bold;
        }
        #link{
            font-size: small;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-decoration: underline;
        }
        #titleheader{
            font-size: x-large;
        }
        #quoteheader{
            font-size: small;
            padding-left: 0;
        }
    </style>
    <script src="js/circuit.js"></script>
        
</head>
<body>
    <div class="wrapper">
        <div id="toc"></div>    
    <header id="headtoc">
        <h1 class="header" id="titleheader">Analog Integrated Systems</h1>
        <p class="header">Experimenting and Learning</p>
        <ul>
            <li id="link" class="download"><a class="buttons" href="index.html">MainPage</a></li>
            <li id="link"><a class="buttons github" href="projects.html">Projects</a></li>
        </ul>
            <p class="header">Feel free to contact me if you don't understand anything</p>
          <p class="header">This project is maintained by <a class="header name" href="https://github.com/hishamelreedy/">HishamElreedy</a></p>
          <p class="header"><blockquote id="quoteheader">اللهم لا علم لنا الأ ما علمتنا به انك انت علام الغيوب</blockquote></p>
        </header>
    <section>
        <h1>PLL Project</h1>
        <h2>Theoretical Part:</h2>
        <h3>a)what is the application of Clock and Data Recovery (CDR) circuit? <br/>
            Describe briefly how to use PLL in CDR Applications</h3>
            <p>
                Clock recovery is the process of extracting timing information from a serial data stream to allow receiving circuit
                to decode the transmitted symols. Clock recovery from the data stream is expedited by modifying the transmitted data where
                in serial communication channel doesn't transmit the clock signal along with the data stream, the clock must be regenerated
                at the receiver using the timing information from the data stream
            </p>
            <ul>
                <li><span class="notbold">The CDR recovers the exact timing of the incoming data</span></li>
                <figure>
                    <img src="images/pllcdrandddr.png"/>
                    <figcaption>CDR and DDR</figcaption>
                </figure>
                <li><span class="notbold">The recovering timing is utilized to sample the data at the optimum time</span></li>
                <li><span class="notbold">CDR minmizes jitter of the input signal</span></li>
                <li><span class="notbold">Due to TX and channel non-idealitieis signal integrity is compromised at the RX input</span></li>
                <figure>
                    <img src="images/txnonidealideal.png"/>
                    <figcaption>TX</figcaption>
                </figure>
                <li><span class="notbold">Non-idealities in data transition time is defined as excess phase (or jitter)</span></li>
                <li><span class="notbold">The clock and data recovery (CDR) system is reponsible for dealing with jitter</span></li>
            </ul>
        <h3>b)Describe briefly how to use a PLL in modulation/demodulation applications</h3>
        <p>
            Demodulation of frequency modulation (FM): If PLL is locked to a FM signal, the VCO tracks the instantaneous 
            frequency of the input signal. The filtered error voltage which controls the VCO and
             maintains lock with the input signal is demodulated FM output.
              The VCO transfer characteristics determine the linearity of the demodulated out.
             Since the VCO used in an integrated-circuit PLL is highly linear, it is possible to realize highly linear FM demodulators.
        </p>
            <figure>
                <img src="images/pllfrequencymodulation.png"/>
                <figcaption>PLL in Modulation and Demodulation</figcaption>
            </figure>
            $$X_{FM}(t)={A_ccos[\omega_ct+K_{VCO}\int^t_{-\infty}{x_{BB}(\tau)d\tau}]}$$
            <figure>
                <img src="images/pllvcoblock.png"/>
                <figcaption>VCO</figcaption>
            </figure>
        <h3>c)Describe briefly the operation of a Delay Locked Loop (DLL) <br/>
            and mention the advantages & disadvantages compared to a PLL.</h3>
            <p>
                Delay locked loop is used to synchronize signal that is spreaded using Direct-Sequence Scheme 
                where we also replaces the internal Voltag-Controlled-Oscillator, by a delay ine. and we use DLL
                to change the phase of clock signal and also to use it in clock recovery
            </p>
        <h3>d)Show the schematic of a dual-modulus (2/3) divider. <br/>
            Hint: This is composed of a divide-by-2 and a divide-by-3 circuits. <br/>
            Simulate the divider in both modes using ideal logic (using Cadence).</h3>
            <p>
                A 2/3 divider cell comprises two functional blocksThe prescaler logic block divides \(F_{in}\), 
                upon control by the end-of-cycle logic,
                the frequency of the input signal either by 2 or by 3, and outputs the divided
                clock signal to the next cell in the chain The end-of-cycle logic controls the
                momentaneous division ratio of the cell. The division ratio depends on the
                state of \(mod_{in}\) and p signals,The\(mod_{in}\) signal becomes active once in
                a division cycle. At that moment, the state of the p input is checked, and if p=1
                the end-of-cycle logic forces the prescaler to swallow one extra period
                of the input signal. In other words, the cell divides by 3. If p=0, the cell stays
                in division by 2 mode. Regardless of the state of the p input, the end-of-cycle
                logic reclocks the \(mod_{in}\) signal, and outputs it to the preceding cell in the chain
            
            </p>
            <figure>
                <img src="images/dualmodulus.png"/>
                <figcaption>Dual Modulus 2/3 Cell</figcaption>
            </figure>
            <p>
                Simulation didnot work well in cadence so I made it in simulink with the following block diagram<br/>
                The Dual Modulus Prescaler subsystem block consists of a program counter, a swallow counter and a prescaler.
                When the block first receives an input signal, the pulse swallow function is activated. The prescaler divides the input signal 
                frequency by (N+1), where N is defined by the Prescaler divider value (N) parameter. 
                Both the program and swallow counters start counting. The swallow counter resets after counting to S pulses, 
                or (N+1)S cycles, where S is defined by the Swallow counter value (S) parameter. 
                Then, the pulse swallow function is deactivated, and the prescaler divides the input frequency by N.
                Since the program counter has already sensed S pulses, it requires (P-S) more pulses, or (P-S)N cycles to reach overflow, 
                where P is defined by the Program counter value (P) parameter. The cycle repeats after both counters are reset.
                $${{f_{in}}\over{f_{out}}}=(N+1)S+N(P-S)=NP+S={2 \over 3}$$
            </p>
            <figure>
                <img src="images/bdmodulus.png"/>
                <figcaption>Dual Modulus Prescaler</figcaption>
            </figure>
            <figure>
                <img src="images/dualmodulussim.png"/>
                <figcaption>Dual Modulus Prescaler I/p Frequency 8MHz and o/p 2MHz</figcaption>
            </figure>
        <h3>e)What is an all-digital PLL (ADPLL)? <br/>
            Show the block diagram and the main building blocks</h3>
            <p>
                all-digital PLL has all digital elements, including the phase detector, loop filter and 
                oscillator; they don't have the supply limitations of analog PLL ands and advanced all 
                digital phase locked loops are fully synthesizable and customizable. each elements we 
                were designing in analog pll we connect it to ADC and DAC inorder to control it digitally
            </p>
            <figure>
                <img src="images/adpll2.png"/>
                <figcaption>All Digital PLL</figcaption>
            </figure>
        <h2>Simulation Part:</h2>
        <p>
            The purpose of this part is to simulate the (linear) PLL circuit in Simulink environment. As discussed in the lecture, 
            the PLL is widely employed in communication and electronic application as it has many functions. 
            In this project, you are going to simulate the PLL as a circuit that performs synchronization between two signals that have different phase and frequency.
        </p>
        <figure>
            <img src="images/pllbd.png"/>
            <figcaption>Fig(1):Phase Locked Loop</figcaption>
        </figure>
        <figure>
            <img src="images/pllbdsim.png"/>
            <figcaption>Fig(2):Simulink Model for PLL</figcaption>
        </figure>
        <h3>Question 1,2,3</h3>
        <p>
            The type of PLL shown in fig(2) is linear model for PLL where, The Model in Figure 2 has three main components:
        </p>
        <ul>
            <li>The phase frequency detector (PFD):<span class="notbold">identify phase shift between reference signal</span></li>
            <li>The loop filter (LF):<span class="notbold">it is the controller of the PLL which takes voltage input from detector to generate required signal for VCO</span></li>
            <li>The voltage controlled oscillator (VCO):<span class="notbold">Generates oscillating frequency according to dc voltage input</span></li>
            <li>The oscillator: <span class="notbold">the signal generator that generates the sinusoidal signal we want to synchronize with</span></li>
            <li>The scope: <span class="notbold">a visualization block that displays the signal with time</span></li>
        </ul>
        <h3>Question 4,5,6</h3>
        <h4>Question 4</h4>
        <ul>
            <li><span class="notbold">The input is a sinusoidal with frequency of \(10^6Hz\) and zero initial phase</span></li>
            <li><span class="notbold">The VCO has a free running code of \(10^6 Hz\) and gain \(K_{VCO}\) of \(10^5\)Hz/Volt</span></li>
            <li><span class="notbold">The low pass filter has a pass-band edge frequency \(10^6\)Hz, order 7, and Butterworth type</span></li>
        </ul>
        <figure>
            <img src="images/linearpllsimulation.png"/>
            <figcaption>Linear PLL Simulation</figcaption>
        </figure>
        <h4>Question 5</h4>
        <ul>Repeat Question 4 with the following setup change:
            <li><span class="notbold">The input is sinusoid with frequency equal to \(10^6Hz\) and phase shift of \(\pi \over 3\)</span></li>
        </ul>
        <figure>
            <img src="images/linearpllpi3.png"/>
            <figcaption>Linear PLL @\(\pi \over 3\) phase shift</figcaption>
        </figure>
        <h4>Question 6</h4>
        <ul>
            <li><span class="notbold">The input is a sinusoidal with a frequency equal to \(10^6\) and initial phase shift of \(\pi \over 5\)</span></li>
        </ul>
        <figure>
            <img src="images/linearpllsimulation.png"/>
            <figcaption>Linear PLL @\(\pi \over 3\) phase shift</figcaption>
        </figure>
        <h3>Question 7&8&9</h3>
        <h4>Question 7</h4>
        <p>
            Testing the circuit after making:
            <ul>
                <li><span class="notbold">The input is sinusoid with frequency equal to \(10^6+10^4\)Hz and 0 initial phase</span></li>
                <li><span class="notbold">The input has a free running frequency of \(10^6\)Hz and gain \(K_{VCO}\) of \(10^5\)Hz/Volt</span></li>
                <li><span class="notbold">The low pass filter has pass-band edge frequency of \(10^6\)Hz, order 7 and Butterworth type</span></li>
            </ul>
        </p>
        <figure>
            <img src="images/freqmodulation.png"/>
            <figcaption>VCO & Reference Output</figcaption>
        </figure>
        <figure>
            <img src="images/VCOFM.png"/>
            <figcaption>LPF Output</figcaption>
        </figure>
        <h4>Question 8</h4>
        <p>
            Repeat Question 7 with the following setup change:
            <ul>
                <li>The input is a sinusoid with frequency equal to \(10^6 - 10^4\)Hz and 0 initial phase</li>
            </ul>
        </p>
        <figure>
            <img src="images/VCOandRefq8.png"/>
            <figcaption>VCO & Reference Output</figcaption>
        </figure>
        <figure>
            <img src="images/lpfq8.png"/>
            <figcaption>LPF Output</figcaption>
        </figure>
        <h4>Question 9</h4>
        <p>
            Repeat Question 7 with the following setup change:
            <ul>
                <li>The VCO has a free running frequency of \(10^6\)Hz and gain \(K_{VCO}\) of \(2*10^5\)Hz/Volt</li>
            </ul>
        </p>
        <figure>
            <img src="images/vco&refq9.png"/>
            <figcaption>VCO & Reference Output</figcaption>
        </figure>
        <figure>
            <img src="images/lpfq9.png"/>
            <figcaption>LPF Output</figcaption>
        </figure>
        <figure>
            <img src="images/ripplesq9.png"/>
            <figcaption>Ripples</figcaption>
        </figure>
    <p>
        $$\phi_e={{\omega_{out}-\omega_o}\over{K_{PD}*K_{VCO}}}$$
        $$VCO_{out}=K_{PD}*\phi_e$$
        $$\omega_{out}=\omega_o + K_{VCO}*VCO_{out}$$
        the filter in 7,8,9 will settle at 0.1, -0.1 and 0.05 Volts respectively with some ripples
        $$Case7:\space \phi_e={{\pi \over 2}+\Delta \phi}$$
        $$Case8:\space \phi_e={{\pi \over 2}-\Delta \phi}$$
        $$Case9:\space \phi_e={{\pi \over 2}+{{\Delta \phi}\over 2}}$$
        Increasing VCO gain decreases SS value of the filter as the filter will need less voltage to achieve required F lock
    </p>
    <h3>Question 10</h3>
    <p>
        Repeat Question 7 with the following setup change:
        <ul>
            <li>The low pass filter has pass-band edge frequency of \(10^5\)Hz, order 7 and Butterworth type</li>
        </ul>
    </p>
    <figure>
        <img src="images/q10refvco.png"/>
        <figcaption>VCO & Reference Output</figcaption>
    </figure>
    <figure>
        <img src="images/lpfq10.png"/>
        <figcaption>LPF Output</figcaption>
    </figure>
    <p>
        <ul>
            <li><span class="notbold">Output doesn't lock to the input</span></li>
            <li><span class="notbold">\(\tau={1\over{\zeta \omega_n}}={2\over{\omega_{LPF}}}\), then 
                if \(\omega_{LPF}\) decreases, \(\tau\) increases, speed decreases and then stability decreases.
            </span></li>
            <li><span class="notbold">\(VCO_{out}\) is critically stable</span></li>
            <li><span class="notbold">\(\phi_e\) will be changed in a specific range</span></li>
        </ul>
    </p>
    <h3>Question 11</h3>
    <p>
        Repeat Question 7 with the following setup change:
        <ul>
            <li>The input is a sinusoid with frequency \((10^6 + 10^5)\)Hz and 0 initial phase</li>
        </ul>
    </p>
    <figure>
        <img src="images/refvcoq11.png"/>
        <figcaption>VCO & Reference Output</figcaption>
    </figure>
    <figure>
        <img src="images/lpfq11.png"/>
        <figcaption>LPF Output</figcaption>
    </figure>
    <p>
        <li><span class="notbold">\(W_{in}=(10^6 + 10^5)*2\pi\)rad/s, the o/p of the filter will be oscillated without ripples at low time because 
        of frequency of \(VCO_{out}\)</span></li>
            <li><span class="notbold">and this oscillates because of the increase in \(\Delta W_{in}\) which leads to increase
                in control voltage to increase \(\omega_out\)
            </span></li>
    </p>
    </section>
<footer>
    <p><small>Hosted on <a href="https://www.github.com/hishamelreedy/">GitHub Pages</a> by HishamElreedy</small></p>
</footer>
</div>
    <script src="js/common.js"></script>
    <script>$('#toc').toc();</script>
</body>
</html>